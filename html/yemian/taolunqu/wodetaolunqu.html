<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <meta content="black" name="apple-mobile-web-app-status-bar-style" />
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>我的討論區</title>
    <script typet="text/javascript" src="https://cdn.bootcss.com/jquery/2.2.0/jquery.min.js"></script>
    <script typet="text/javascript" src="../../static/common.js"></script>

    <link href="https://cdn.bootcss.com/Swiper/3.4.2/css/swiper.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/Swiper/3.4.2/js/swiper.jquery.min.js"></script>
    <link href="../../static/common.css" rel="stylesheet">
    <link href="../../static/commonS.css" rel="stylesheet">
    <link href="../../static/imgUp.css" rel="stylesheet">
    <link rel="stylesheet" href="../../static/mui.min.css">
<style scoped>
  /*下面的列表*/
  /*讨论区的标题*/
.mui-btn-green, .muiBtnGreen, .mui-btn-positive, .mui-btn-success{
      color: #fff !important;
    border: 1px solid #36C748 !important;
    background-color: #36C748 !important;
}
.mui-btn-grey, .muiBtnGrey{
  color: #656565 !important;
    border: 1px solid #656565 !important;
    background-color: white;
}
  .taolunqu .mui-segmented-control.mui-segmented-control-inverted .mui-control-item {
    color: #000000;
    font-weight: 500;
    border-bottom: 0.07rem solid #FFFFFF;
  }
  
  .taolunquli {
    padding: 0;
  }
  
  .taolunqu .mui-segmented-control.mui-segmented-control-inverted .mui-control-item.mui-active {
    color: #36C748;
  }
  /*#sliderSegmentedControl{padding:0 0.2rem;}*/
  
  .taolunqu .mui-slider-indicator.mui-segmented-control {
    background: white;
  }
  
  .taolunqu .mui-segmented-control.mui-scroll-wrapper,
  .taolunqu .mui-segmented-control.mui-scroll-wrapper .mui-scroll {
    height: 0.7rem;
  }
  /*.taolunqu .mui-segmented-control .mui-control-item{height: 0.4rem;line-height: 0.4rem;}*/
  /*顶部标题*/
  
  .taolunqu .mui-segmented-control.mui-scroll-wrapper .mui-control-item {
    width: 33%;
  }
  
  .mui-fullscreen .mui-segmented-control~.mui-slider-group {
    top: 0.8rem !important;
    transform: none !important;
  }
  
  .taolunqu .mui-card-footer:before {
    height: 0;
  }
  
  .taolunqu .mui-card-footer {
    padding: 0;
    min-height: 0.35rem;
  }
  
  .taolunqu .mui-table-view-cell:after {
    left: 0;
  }
  
  .tapa {
    height: 0.7rem !important;
    line-height: 0.7rem !important;
    overflow: visible !important;
  }
  /*我的回复*/
  
  .taolunquli2:after,
  .taolunquli3:after {
    left: 1.3rem !important;
  }
  
  /*列表图片的张数*/
.onepic{width:5rem;height:5rem;}
.twopic{width:2.45rem;height:2.45rem;}
.pics>.twopic:first-child{margin-right:0.05rem;}
.morepic{width:1.63rem;height:1.63rem;margin-bottom:0.05rem;}
.pics>.morepic:nth-child(2){margin-left:0.05rem;margin-right:0.05rem;}
.pics>.morepic:nth-child(5){margin-left:0.05rem;margin-right:0.05rem;}
.pics>.morepic:nth-child(8){margin-left:0.05rem;margin-right:0.05rem;}
.pics>.morepic:nth-child(11){margin-left:0.05rem;margin-right:0.05rem;}

.mui-slider-group>.mui-control-content.mui-active{
  display:inline-block !important;
}
.mui-slider-group>.mui-control-content{
  display:none !important;
}
</style>

  </head>

  <body>

<div id="app" v-cloak>
<div id=""  class="fixbody">

    <!--讨论区列表-->

    <div id="slider" @slide='sliders($event)' class="WODETAOLUNQU mui-slider mui-fullscreen taolunqu" style="">

      <div id="sliderSegmentedControl" style="height:0.7rem;" class="bai mui-scroll-wrapper mui-slider-indicator mui-segmented-control mui-segmented-control-inverted">
        <div class="mui-scroll fz25" style="width:100%;">
          <a @tap="qiehuan(1)" class="tapa relative mui-control-item mui-active" data-index='1' href="#item1mobile">
            我的貼文
            <span v-show="datasIdx==1" style="width:0.5rem;border-bottom:0.05rem solid #36C748;bottom:0rem;" class="spjz"></span>
          </a>
          <a @tap="qiehuan(2)" class="tapa relative mui-control-item" data-index='2' href="#item2mobile">
            我的讃好
            <span v-show="datasIdx==2" style="width:0.5rem;border-bottom:0.05rem solid #36C748;bottom:0rem;" class="spjz"></span>
            <span style="height:0.18rem;width:0.18rem;bottom:-0.25rem;background: red;right:0.28rem;" class="czjz radius50"></span>
            <span style="width:0;height:0.3rem;left:0;margin-top:0.05rem;" class="czjz border-l"></span>
            <span style="width:0;height:0.3rem;right:0;margin-top:0.05rem;" class="czjz border-l"></span>
          </a>
          <a @tap="qiehuan(3)" class="tapa relative mui-control-item  border-r" data-index='3' href="#item3mobile">
            我的回復
            <span v-show="datasIdx==3" style="width:0.5rem;border-bottom:0.05rem solid #36C748;bottom:0rem;" class="spjz"></span>
            <span style="height:0.18rem;width:0.18rem;bottom:-0.25rem;background: red;right:0.28rem;" class="czjz radius50"></span>
          </a>

        </div>
      </div>
      <div class="mui-slider-group wai">
        <!--1.我的貼文-->
        <div id="item1mobile" class="mui-slider-item mui-control-content mui-active border0">
          <div id="scroll1" class="mui-scroll-wrapper">
            <div class="mui-scroll">
              <ul class="mui-table-view">
                <li class="mui-table-view-cell taolunquli" v-for="(item,index) in datas1">
                  <ul class="mui-table-view">
                    <li class="mui-table-view-cell mui-media padding20">
                      <a href="javascript:;" class="padding0 margin0">
                        <div @tap="zhezhaocengs(item)" class="mui-media-object mui-pull-left relative center" style="max-width:0.8rem;width:0.8rem;height:1.5rem;margin-right:0.15rem;">
                          <!--个人头像-->
                          <div class="radius50 overflow" style="max-width:0.8rem;width:0.8rem;height:0.8rem;">
                            <img :src="item.user.avatar!=undefined&&item.user!=undefined?item.user.avatar.url:'../../assets/img/taolunqu/head.png'" style="width:100%;">
                          </div>

                          <img src="../../assets/img/taolunqu/zong.png" alt="" class="spjz" style="margin-top:0.05rem;width:0.3rem;" />
                          <span class="fz23 cff4d00 mui-block spjz" style="height:0.4rem;line-height: 0.4rem;margin-top:0.4rem;">{{item.user.likes}}</span>

                        </div>
                        <div class="mui-media-body fz23 cff4d00">
                          {{(!isNaN(item.user.nickname)==false?item.user.nickname:item.user.nickname.substring(0,2)+'****'+item.user.nickname.substring(item.user.nickname.length,item.user.nickname.length-2))}}
                          <p @tap="xiangqing(item.objectId)" class="mui-ellipsis fz30 c000000 relative bold"  :class="{pL55:item.tag!='綜合'}" style="height:0.5rem;line-height:0.5rem;">
                            <button v-if="item.tag!='綜合'" type="button" class="mui-btn mui-btn-green czjz" style="font-size: 0.21rem;left:0rem;">{{item.tag}}
                                      </button> {{item.title}}

                          </p>
                          <p @tap="xiangqing(item.objectId)" class="mui-ellipsis-2 fz25 c888888" style="margin-top:0.1rem;">{{item.content}}</p>
                          <div style="margin:0.15rem 0 0 0;">
                            <!--列表大图-->
                            <div class="mui-card-content">
                              <ul class="overflow pics">
                                <li class="mui-pull-left overflow" v-for="(pic,idx) in item.pics" :class="{onepic:item.pics.length==1,twopic:item.pics.length==2,morepic:item.pics.length>2}">
                                  <img :src="item.pics.length==1?pic.url+imageView1:(item.pics.length==2?pic.url+imageView2:pic.url+imageView3)" alt="" :data-preview-src="pic.url" :data-preview-group="'1'+index" />
                                </li>
                              </ul>

                            </div>
                            <!--页脚，放置补充信息或支持的操作-->
                            <div class="mui-card-footer fz21 c666666" @tap="xiangqing(item.objectId)">
                              <span>{{item.createdAt}}</span>

                              <span>
                                  <img src="../../assets/img/taolunqu/zan.png"  alt="" style="width:0.3rem;top:0.05rem;" class="relative"/>
                                    <span class="fz25 c666666">{{item.goods}}</span>
                              </span>
                              <span>
                                   <img src="../../assets/img/taolunqu/reply.png" alt="" style="width:0.3rem;top:0.05rem;" class="relative"/>
                                   <span class="fz25 c666666">{{item.comments}}</span>
                              </span>

                            </div>
                          </div>
                        </div>
                      </a>
                    </li>

                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <!--2.我的讃好-->
        <div id="item2mobile" class="mui-slider-item mui-control-content border0">
          <div id="scroll2" class="mui-scroll-wrapper">
            <div class="mui-scroll">
              <p class="center fz23" style="padding:0.05rem 0 0.15rem 0;">
                <button :class="{muiBtnGreen:tab2Idx==1,muiBtnGrey:tab2Idx==2}" @tap="tap2fachu(1)" type="button" class="mui-btn" style="margin-right:1.9rem;border-radius:0.3rem;padding:0.12rem 0.34rem !important;">已發出</button>
                <button :class="{muiBtnGreen:tab2Idx==2,muiBtnGrey:tab2Idx==1}" @tap="tap2shoudao(2)" type="button" class="mui-btn" style="border-radius:0.3rem;padding:0.12rem 0.34rem !important;">已收到</button>
                <!--收到的信息量-->
                <span class="mui-badge mui-btn-red absolute bold" style="background:red;color:white;right:0.5rem;top:-0.01rem;">158</span>
              </p>
              <ul class="mui-table-view">
                <li @tap="xiangqing(item.objectId)" class="mui-table-view-cell taolunquli taolunquli2" v-for="(item,index) in datas2">

                  <ul class="mui-table-view">
                    <li class="mui-table-view-cell mui-media ">
                      <a href="javascript:;">
                        <div  class="mui-media-object mui-pull-left radius50 overflow" style="max-width:0.8rem;width:0.8rem;height:0.8rem;">
                          <!--个人头像-->
                          <!--已发出都是拿显示自己的资料-->
                          <img v-if="tab2Idx==1" :src="user.avatar!=undefined&&user!=undefined?user.avatar.url:'../../assets/img/taolunqu/head.png'"  style="width:100%;">
                          <!--已收到都是拿循环的数据-->
                          <img  v-if="tab2Idx==2"  :src="item.user.avatar!=undefined&&item.user!=undefined?item.user.avatar.url:'../../assets/img/taolunqu/head.png'"  style="width:100%;">
                          
                        </div>
                        <div class="mui-media-body fz23 c282828">
                          <!--已发出都是拿显示自己的资料-->
                           {{tab2Idx==1?isnan(user.nickname):isnan(item.user.nickname)}}
                          <p class="fz18 c666666">{{item.goodAt}}</p>
                          <p><img src="../../assets/img/taolunqu/dilanzanlv.png" alt="" style="width:0.35rem;" /></p>
                          <p class="relative fz25 c777777 whiteSpace bgeeeeee radius" style="margin-top:0.1rem;padding:0.2rem;">
                            <img class="absolute" src="../../assets/img/taolunqu/san.png" alt="" style="top:-0.1rem;left:0.3rem;width:0.3rem;" /> 
                            回復{{returns(item.user.nickname)}}的主題：{{item.title}}
                          </p>
                        </div>
                      </a>
                    </li>

                  </ul>
                </li>

              </ul>
            </div>
          </div>
        </div>
        <!--3.我的回復-->
        <div id="item3mobile" class="mui-slider-item mui-control-content border0">
          <div id="scroll3" class="mui-scroll-wrapper">
            <div class="mui-scroll">
              <p class="center fz23 overflown" style="padding:0.05rem 0 0.15rem 0;">
                <button @tap="tap3fachu(1)" type="button" :class="{muiBtnGreen:tab3Idx==1,muiBtnGrey:tab3Idx==2}" class="mui-btn" style="margin-right:1.9rem;border-radius:0.3rem;padding:0.12rem 0.34rem !important;">已發出</button>
                <button @tap="tap3shoudao(2)" type="button" :class="{muiBtnGreen:tab3Idx==2,muiBtnGrey:tab3Idx==1}" class="mui-btn" style="border-radius:0.3rem;padding:0.12rem 0.34rem !important;">已收到</button>
                <!--收到的信息量-->
                <span class="mui-badge mui-btn-red absolute bold" style="background:red;color:white;right:0.5rem;top:-0.01rem;">158</span>
              </p>
              <ul class="mui-table-view">
                <li @tap="xiangqing(item.objectId)" class="mui-table-view-cell taolunquli taolunquli3" v-for="(item,index) in datas3" v-if="item.isDelete!=1">
                  <ul class="mui-table-view">
                    <li class="mui-table-view-cell mui-media " >
                      <a href="javascript:;">
                        <div class="mui-media-object mui-pull-left radius50 overflow" style="max-width:0.8rem;width:0.8rem;height:0.8rem;">
                          <!--个人头像-->
                          <!--已发出都是拿显示自己的资料-->
                          <img v-if="tab3Idx==1" :src="user.avatar!=undefined&&user!=undefined?user.avatar.url:'../../assets/img/taolunqu/head.png'"  style="width:100%;">
                          <!--已收到都是拿循环的数据-->
                          <img  v-if="tab3Idx==2"  :src="item.user.avatar!=undefined&&item.user!=undefined?item.user.avatar.url:'../../assets/img/taolunqu/head.png'"  style="width:100%;">
                          </div>
                        <div class="mui-media-body fz23 c282828">
                          <!--已发出都是拿显示自己的资料-->
                            {{tab3Idx==1?isnan(user.nickname):isnan(item.user.nickname)}}
                          <p class="fz18 c666666">{{item.createdAt}}</p>
                          <div class="fz25 c333333" style="white-space: normal;">
                            {{item.comment}}                                                                                                </div>
                          <p class="relative fz25 c777777 whiteSpace bgeeeeee radius" style="margin-top:0.2rem;padding:0.2rem;">
                            <img class="absolute" src="../../assets/img/taolunqu/san.png" alt="" style="top:-0.1rem;left:0.3rem;width:0.3rem;" /> 
                            回復{{returns2(item.post.user.nickname)}}主題：{{item.post.title}}                       
                          </p>
                        </div>
                      </a>
                    </li>

                  </ul>
                </li>

              </ul>
            </div>
          </div>
        </div>

      </div>
    </div>

<!--弹出框个人资料-->
  <div class="mui-backdrop" v-if="zhezhaoceng==true">
    <div class="radius bai jz" style="width:6rem;height:5.23rem;padding:0.7rem 0.25rem;">
       <img @tap="closes()" src="../../assets/img/taolunqu/close.png" alt="" class="absolute" style="width:0.52rem;top:0.25rem;right:0.25rem;"/>
       <div style="height:1.64rem;width:1.64rem;" class="radius50 overflow center margin">
               <img :src="zhezhaocengItem.user.avatar!=undefined&&zhezhaocengItem.user!=undefined?zhezhaocengItem.user.avatar.url:'../../assets/img/taolunqu/head.png'"  alt=""  style="width:1.64rem;"/>
       </div>
       <p class="fz30 c000000 center" style="margin:0.27rem 0 0.15rem 0;">
         {{(!isNaN(zhezhaocengItem.user.nickname)==false?zhezhaocengItem.user.nickname:zhezhaocengItem.user.nickname.substring(0,2)+'****'+zhezhaocengItem.user.nickname.substring(zhezhaocengItem.user.nickname.length,zhezhaocengItem.user.nickname.length-2))}}
       </p>
       <p class="fz25 c888888 center">
        <img src="../../assets/img/xiangqing/phone_gx.png" alt="" style="width:0.2rem;"/>
        手機號碼已驗證
       </p>
      <ul class="overflow fz23 c888888" style="margin-top:0.4rem;">
        <li class="mui-pull-left center border-r" style="width:50%;">
          <p>註冊時間</p>
          <img src="../../assets/img/taolunqu/time.png" alt="" style="width:0.23rem;top:0.05rem;" class="relative"/> 
          <span class="fz25 c888888">{{zhezhaocengItem.user.createdAt.substring(0,10)}}</span>    
        </li>
        <li class="mui-pull-right center" style="width:50%;">
          <p>總讃數</p>
          <img src="../../assets/img/taolunqu/zong.png" alt="" style="width:0.23rem;top:0.05rem;" class="relative"/> 
          <span class="fz25 cff4d00">{{zhezhaocengItem.user.likes}}</span>    
        </li>
      </ul>

    </div>
  </div>
  

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
 <script src="https://cdn.bootcss.com/vuex/3.0.1/vuex.min.js"></script>
 <script src="https://cdn.bootcss.com/vue-router/3.0.1/vue-router.min.js"></script>

    <script src="../../static/vconsole.min.js"></script>
    <script src="../../static/mui.min.js"></script>
    <script src="../../templated/liebiao.js"></script>
    <script src="../../static/imgUp.js"></script>
    <script src="../../static/mui.pullToRefresh.js"></script>
    <script src="../../static/mui.pullToRefresh.material.js"></script>
    <script src="../../static/mui.zoom.js"></script>
    <script src="../../static/mui.previewimage.js"></script>
    <script src="../../static/public.js"></script>
    <script type="text/javascript">
      // 初始化previewImage
      mui.previewImage();
      mui.init();
      var objectId = '58bd0b8b1b69e6006b274f76' //'587f3b29570c352201193d6e'
      var user = '';
    </script>
<script>
    var vm = new Vue({
        el: '#app',
        data: {
       imageView1:'?imageView2/1/w/'+parseInt(500*w0)+'/h/'+parseInt(500*w0),
        imageView2:'?imageView2/1/w/'+parseInt(245*w0)+'/h/'+parseInt(245*w0),
        imageView3:'?imageView2/1/w/'+parseInt(163*w0)+'/h/'+parseInt(163*w0),
        user:user,//个人资料
        datasIdx: 1,
        zhezhaoceng: false, //个人头像弹出框
        datas1: [], //我的贴文
        datas2: [], //我的攒好
        datas3: [], //我的回复
        count1: '',
        count2: '',
        count3: '',
        page1: 0,
        page2: 0,
        page3: 0,
        // text: '点点滴滴呃呃呃滴答滴答滴答滴答的的点点滴滴的点点滴滴呃呃鹅鹅鹅饿饿鹅鹅鹅饿饿的的点点滴滴的点点滴滴的的点点滴滴的点点滴滴搜索事实是搜索事实是搜索搜索事实是搜索事实是',
        tab2Idx: 1, //我的攒好的已发出已收到按钮下标
        tab3Idx: 1 //我的回复的已发出已收到按钮下标 1.已发出的回复=查看用户发出的帖文回复 2.已收到的回复=查看用户帖文回复收信箱

      },
       methods: {
      //个人资料弹出框
      zhezhaocengs(item){
        this.zhezhaocengItem=item
        this.zhezhaoceng=true
      },
      //禁止轮播左右滑动
      sliders(e){
          this.datasIdx=e.detail.slideNumber+1
      },
      //
      returns(name){
        if(this.tab2Idx==2){
          return '我的'
        }else{
             if(!isNaN(name)==false){
                     return name
              }else{
                    return name.substring(0,2)+'****'+name.substring(name.length,name.length-2)
              }
        }
        
      },
      returns2(name){
        if(this.tab3Idx==2){
          return '我的'
        }else{
             if(!isNaN(name)==false){
                     return name
              }else{
                    return name.substring(0,2)+'****'+name.substring(name.length,name.length-2)
              }
        }
        
      },
      //判断用户名是否含数字
      isnan(name){
        if(!isNaN(name)==false){
          return name
        }else{
          return name.substring(0,2)+'****'+name.substring(name.length,name.length-2)
        }
          
      },
      //点击标签切换
      qiehuan(index) {
        // 主动上拉加载 
        this.datasIdx = index
        //切换的时候要判断切换去的标签是否是第一次进入，是则调用方法，否则就不调用，用当前标签是否页数为0来判断
        if(index == 1) {
          $('#item1mobile').addClass('mui-active')
          if(this.page1 == 0) {
            this.refresh()
          }
        } else if(index == 2) {
//          $('#item2mobile').addClass('mui-active')
          if(this.page2 == 0) {
            this.refresh()
          }
        } else if(index == 3) {
          $('#item3mobile').addClass('mui-active')
          if(this.page3 == 0) {
            this.refresh()
          }
        }

      },
      //点击关闭个人资料弹出框的叉子
      closes() {
        this.zhezhaoceng = false
      },

      //点击题目和描述跳到对应的讨论区详情
      xiangqing(n) {
        location.href="taolunquXq.html?objectId="+n+'&sessiontoken='+sessiontoken
        // if(isAPP){
        //   locationClick('taolunquXq/'+n)
        // }else{
        //   this.$router.push({name:'taolunquXq',params:{objectId:n}})
        // }
//        this.$router.push({
//          name: 'taolunquXq',
//          params: {
//            objectId: n
//          }
//        })
      },
      //2我的攒好已发出
      tap2fachu(index) {
        this.tab2Idx = index
        this.datas2=[]
                this.page2=0
            this.refresh()
          
      },
      //3我的攒好已收到
      tap2shoudao(index) {
        this.tab2Idx = index
         this.page2=0
         this.datas2=[]
            this.refresh()
      },
      //3我的回复已发出
      tap3fachu(index) {
        this.tab3Idx = index
         this.page3=0
         this.datas3=[]
            this.refresh()
      },
      //3我的回复已收到
      tap3shoudao(index) {
        this.tab3Idx = index
         this.page3=0
         this.datas3=[]
            this.refresh()
      },
      refresh() {
        var that = this;
        (function($) {
          //阻尼系数
          var deceleration = mui.os.ios ? 0.003 : 0.0009;
          $('.mui-scroll-wrapper').scroll({
            bounce: false,
            indicators: true, //是否显示滚动条
            deceleration: deceleration
          });
          $.ready(function() {
            //循环初始化所有下拉刷新，上拉加载。
            $.each(document.querySelectorAll('.wai .mui-scroll'), function(index, pullRefreshEl) {
              $(pullRefreshEl).pullToRefresh({
                //刷新              
                down: {
                  auto: true, //可选,默认false.首次加载自动下拉刷新一次
                  callback: function() {
                    var self = this;
                    var url = ''
                    if(that.datasIdx == 1) { //1.我的帖文
                      url = 'user/post' //get
                      that.page1 = 1
                    } else if(that.datasIdx == 2) { //2.我的攒好
                      if(that.tab2Idx == 1) { //a.已发出：查看用户赞赏的帖文列表
                        url = 'user/good/posts'
                      } else if(that.tab2Idx == 2) { //b.已收到：查看用户被赞赏的帖文列表
                        url = 'user/posts/good'
                      }
                      that.page2 = 1
                    } else if(that.datasIdx == 3) { //3.我的回复
                      if(that.tab3Idx == 1) { //a.已发出：查看用戶發出的帖文回復
                        url = 'user/comment'
                      } else if(that.tab3Idx == 2) { //b.已收到：查看用戶帖文回復收信箱
                        url = 'user/inbox/comment'
                      }
                      that.page3 = 1
                    }
                    mui.ajax(Boss + url, {
                      data: {
                        page: 1,
                        limit: limit20,
                        sessiontoken: sessiontoken
                      },
                      dataType: 'json', //服务器返回json格式数据
                      type: 'GET', //HTTP请求类型
                      timeout: 10000, //超时时间设置为10秒；
                      //  headers:{'Content-Type':'application/json'},                
                      success: function(data) {
                        //服务器返回响应，根据响应结果，分析是否登录成功；
                        if(data.status == true) {
                          that.slideimg = data.result.slider
                          //获得slider插件对象
                          setTimeout(function() {
                            var gallery = mui('.xiangqingSlider');
                            gallery.slider({
                              interval: 3000 //自动轮播周期，若为0则不自动播放，默认为0；
                            });
                          }, 100)
                          if(that.datasIdx == 1) {
                            that.count1 = data.result.count
                            that.datas1 = data.result.data
                          } else if(that.datasIdx == 2) {
                            that.count2 = data.result.count
                            that.datas2 = data.result.data
                          } else if(that.datasIdx == 3) {
                            that.count3 = data.result.count
                            that.datas3 = data.result.data
                          }

                        }
                        self.endPullDownToRefresh();

                      },
                      error: function(xhr, type, errorThrown) {
                        //异常处理；
                        self.endPullDownToRefresh();
                        mui.toast(type, {
                          duration: 'long',
                          type: 'div'
                        })
                      }
                    });

                  }
                },
                //滚动加载
                up: {
                  auto: true, //可选,默认false.首次加载自动下拉刷新一次
                  callback: function(item) {
                    var self = this;
                    var page = ''
                    var url = ''                  
                    if(that.datasIdx == 1) { //1.我的帖文
                      url = 'user/post' //get
                      that.page1++
                      page = that.page1
                    } else if(that.datasIdx == 2) { //2.我的攒好
                      if(that.tab2Idx == 1) { //a.已发出：查看用户赞赏的帖文列表
                        url = 'user/good/posts'
                      } else if(that.tab2Idx == 2) { //b.已收到：查看用户被赞赏的帖文列表
                        url = 'user/posts/good'
                      }
                      that.page2++
                        page = that.page2
                    } else if(that.datasIdx == 3) { //3.我的回复
                      if(that.tab3Idx == 1) { //a.已发出：查看用戶發出的帖文回復
                        url = 'user/comment'
                      } else if(that.tab3Idx == 2) { //b.已收到：查看用戶帖文回復收信箱
                        url = 'user/inbox/comment'
                      }
                      that.page3++
                        page = that.page3
                    }
                    mui.ajax(Boss + url, {
                      data: {
                        page: page,
                        limit: limit20,
                        sessiontoken: sessiontoken
                      },
                      dataType: 'json', //服务器返回json格式数据
                      type: 'GET', //HTTP请求类型
                      timeout: 10000, //超时时间设置为10秒；
                      //  headers:{'Content-Type':'application/json'},                
                      success: function(data) {
                        //服务器返回响应，根据响应结果，分析是否登录成功；
                        if(data.status == true) {
                          that.slideimg = data.result.slider
                          //获得slider插件对象
                          setTimeout(function() {
                            var gallery = mui('.xiangqingSlider');
                            gallery.slider({
                              interval: 3000 //自动轮播周期，若为0则不自动播放，默认为0；
                            });
                          }, 100)

                          if(that.datasIdx == 1) {
                            that.count1 = data.result.count
                          
                            //如果是切换标签的加载事件也就是现在请求的是第一页，所以则要让页数变为1，下次加载的时候就变成++
                            if(that.page1 == 1) {
                              that.datas1 = data.result.data
                            } else {
                              for(var i = 0; i < data.result.data.length; i++) {
                                that.datas1.push(data.result.data[i])
                              }
                            }
                          } else if(that.datasIdx == 2) {
                            that.count2 = data.result.pages
                            if(that.page2 == 1) {
                              that.datas2 = data.result.data
                            } else {
                              for(var i = 0; i < data.result.data.length; i++) {
                                that.datas2.push(data.result.data[i])
                              }
                            }
                          } else if(that.datasIdx == 3) {
                            that.count3 = data.result.count
                            if(that.page3 == 1) {
                              that.datas3 = data.result.data
                            } else {
                              for(var i = 0; i < data.result.data.length; i++) {
                                that.datas3.push(data.result.data[i])
                              }
                            }
                          }

                        }
                        if(data.result.data){
                          self.endPullUpToRefresh(true); //没有更多数据
                        }else{
                          self.endPullUpToRefresh(); //加载更多数据
                        }

                      },
                      error: function(xhr, type, errorThrown) {
                        //异常处理；让当前页数变回减1
                        if(that.datasIdx == 1) {
                          that.page1--
                        } else if(that.datasIdx == 2) {
                          that.page2--
                        } else if(that.datasIdx == 3) {
                          that.page3--
                        }
                        mui.toast(type, {
                          duration: 'long',
                          type: 'div'
                        })
                        self.endPullUpToRefresh();
                      }
                    });

                  }
                }
              });
            });

          });
        })(mui);
      }

    },
    mounted() {  
      //调用刷新和加载
      this.refresh()
         
    }
    })

  </script> 





  </body>

</html>